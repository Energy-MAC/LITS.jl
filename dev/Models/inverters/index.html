<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Inverter · LITS.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>LITS.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Models</span><ul><li><a class="toctext" href="../network/">Network</a></li><li><a class="toctext" href="../gens/">Generator</a></li><li class="current"><a class="toctext" href>Inverter</a><ul class="internal"><li><a class="toctext" href="#DC-Source-1">DC Source</a></li><li><a class="toctext" href="#Frequency-Estimators-1">Frequency Estimators</a></li><li><a class="toctext" href="#Outer-Loop-Controls-1">Outer Loop Controls</a></li><li><a class="toctext" href="#Inner-Loop-Controls-1">Inner Loop Controls</a></li><li><a class="toctext" href="#Converter-1">Converter</a></li><li><a class="toctext" href="#Filters-1">Filters</a></li><li><a class="toctext" href="#Reference-1">Reference</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Models</li><li><a href>Inverter</a></li></ul><a class="edit-page" href="https://github.com/Energy-MAC/LITS.jl/blob/master/docs/src/Models/inverters.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Inverter</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Inverter-Models-1" href="#Inverter-Models-1">Inverter Models</a></h1><p>Here we discuss the structure and models used to model inverters in LITS.jl. Each inverter is a data structure that is defined by the following components:</p><ul><li>DC Source: Defines the dynamics of the DC side of the converter.</li><li>Frequency Estimator: That describes how the frequency of the grid can be estimated using the grid voltages. Typically a phase-locked loop (PLL).</li><li>Outer Loop Control: That describes the active and reactive power control dynamics.</li><li>Inner Loop Control: That can describe virtual impedance, voltage control and current control dynamics.</li><li>Converter: That describes the dynamics of the pulse width modulation (PWM) or space vector modulation (SVM).</li><li>Filter: Used to connect the converter output to the grid.</li></ul><p>The following figure summarizes the components of a inverter and which variables they share:</p><img src="../../assets/inv_metamodel.png" width="75%"/><p>⠀</p><p>Contrary to the generator, there are many control structures that can be used to model inverter controllers (e.g. grid-following, grid feeding or virtual synchronous machine). For this purpose, more variables are shared among the components in order to cover all these posibilities.</p><p>Models are based from the paper: &quot;A Virtual Synchronous Machine implementation for distributed control of power converters in SmartGrids&quot; from S. D&#39;Arco, J.A. Suul and O.B. Fosso.</p><h2><a class="nav-anchor" id="DC-Source-1" href="#DC-Source-1">DC Source</a></h2><p>This component can be used to model the dynamics of the DC side of the converter.</p><h3><a class="nav-anchor" id="Fixed-DC-Source-1" href="#Fixed-DC-Source-1">Fixed DC Source</a></h3><p>This is a model that set the DC voltage to a fixed value <span>$v_{\text{dc}} = v_{\text{dc}}^{\text{fix}}$</span>.</p><h2><a class="nav-anchor" id="Frequency-Estimators-1" href="#Frequency-Estimators-1">Frequency Estimators</a></h2><p>This component is used to estimate the frequency of the grid based on the voltage at the bus.</p><h3><a class="nav-anchor" id="Phase-Locked-Loop-(PLL)-for-VSM-1" href="#Phase-Locked-Loop-(PLL)-for-VSM-1">Phase-Locked Loop (PLL) for VSM</a></h3><p>The following equations present a PLL used to estimate the frequency and PLL angle of the grid. There are two reference frames considered in this inverter. Those are the VSM of the outer-loop control <span>$\delta\theta_{\text{olc}}$</span> and the PLL one <span>$\delta\theta_{\text{pll}}$</span>. The notation used a <span>$\delta\theta$</span> to refer as the variation of the respective angle <span>$\theta$</span> with respect to the grid SRF (instead of the fixed <span>$\alpha$</span> component of the <span>$\alpha\beta$</span> transformation):</p><div>\[\begin{align}
\dot{v}_{d,\text{pll}} &amp;= \omega_{\text{lp}} \left [v_d \cos(\delta\theta_{\text{pll}} - \delta\theta_{\text{olc}}) + v_q \sin(\delta\theta_{\text{pll}} - \delta\theta_{\text{olc}}) - v_{d,\text{pll}} \right] \tag{1a} \\
\dot{v}_{q,\text{pll}} &amp;= \omega_{\text{lp}} \left [- v_d \sin(\delta\theta_{\text{pll}} - \delta\theta_{\text{olc}}) + v_q \cos(\delta\theta_{\text{pll}} - \delta\theta_{\text{olc}}) - v_{q,\text{pll}} \right] \tag{1b} \\
\dot{\varepsilon}_{\text{pll}} &amp;= \tan^{-1}\left(\frac{v_{q,\text{pll}}}{v_{d,\text{pll}}} \right) \tag{1c} \\
\dot{\delta\theta}_{\text{pll}} &amp;= \Omega_b \delta \omega_{\text{pll}} \tag{1d}
\end{align}\]</div><p>with</p><div>\[\begin{align}
\delta\omega_{\text{pll}} = k_{p,\text{pll}} \tan^{-1} \left(\frac{v_{q,\text{pll}}}{v_{d,\text{pll}}} \right) + k_{i,\text{pll}} \varepsilon_{\text{pll}} \tag{1e}
\end{align}\]</div><h2><a class="nav-anchor" id="Outer-Loop-Controls-1" href="#Outer-Loop-Controls-1">Outer Loop Controls</a></h2><p>This component defines controllers for both active and reactive power</p><h3><a class="nav-anchor" id="Virtual-Inertia-and-Q-droop-1" href="#Virtual-Inertia-and-Q-droop-1">Virtual Inertia and Q-droop</a></h3><p>The following model represent a virtual synchronous machine model to represent how active power is going to be deployed. It defines a new SRF denoted as <span>$\theta_{\text{olc}}$</span> for the active power controller and uses a simple voltage droop for dispatching reactive power:</p><div>\[\begin{align}
    \dot{\delta\omega}_{\text{olc}} &amp;= \frac{p_{\text{ref}}}{T_a} - \frac{p_e}{T_a} - \frac{k_d(\omega_{\text{vsm}} - \omega_{\text{pll}})}{T_a} - \frac{k_\omega(\omega_{\text{olc}} - \omega_{\text{ref}})}{T_a} \tag{2a} \\
    \dot{\delta\theta}_{\text{olc}} &amp;= \Omega_b \delta\omega_{\text{olc}} \tag{2b} \\
    \dot{q}_m &amp;= \omega_f (q_e - q_m) \tag{2c}
\end{align}\]</div><p>with</p><div>\[\begin{align}
    p_e &amp;= v_di_d + v_qi_q \tag{2d} \\
    q_e &amp;= v_qi_d - v_di_q \tag{2e} \\
    v_{\text{olc}}^{\text{ref}} &amp;= v_{\text{ref}} + k_q(q_{\text{ref}} - q_m) \tag{2f}
\end{align}\]</div><h2><a class="nav-anchor" id="Inner-Loop-Controls-1" href="#Inner-Loop-Controls-1">Inner Loop Controls</a></h2><p>This component defines voltage and current controllers to generate the reference signal for the converter.</p><h3><a class="nav-anchor" id="Integrated-Virtual-Impedance,-Voltage-and-Current-Controller-1" href="#Integrated-Virtual-Impedance,-Voltage-and-Current-Controller-1">Integrated Virtual Impedance, Voltage and Current Controller</a></h3><p>The following model receives both the outer loop control frequency and reference voltage signal to generate the reference signal for the converters. The virtual impedance plays a similar role of the impedance of a synchronous generator. A PI voltage controller is used to generate the current signal that is used in the PI current controller to finally generate the voltage reference signal for the converters.</p><div>\[\begin{align*}
    \dot{\xi}_d &amp;= v_{d,\text{vi}}^{\text{ref}} - v_d \tag{3a} \\
    \dot{\xi}_q &amp;= v_{q,\text{vi}}^{\text{ref}} - v_q \tag{3b} \\
    \dot{\gamma}_d &amp;= i_{d,\text{cv}}^{\text{ref}} - i_{d,\text{cv}} \tag{3c} \\
    \dot{\gamma}_q &amp;= i_{q,\text{cv}}^{\text{ref}} - i_{q,\text{cv}} \tag{3d} \\
    \dot{\phi}_d &amp;= \omega_{\text{ad}}(v_d - \phi_d) \tag{3e} \\
    \dot{\phi}_q &amp;= \omega_{\text{ad}}(v_q - \phi_q) \tag{3f}
\end{align*}\]</div><p>with</p><div>\[\begin{align}
    v_{d,\text{vi}}^{\text{ref}} &amp;= v_{\text{olc}}^{\text{ref}} - r_v i_d + \omega_{\text{olc}} l_v i_q \tag{3g} \\
    v_{q,\text{vi}}^{\text{ref}} &amp;= - r_v i_q - \omega_{\text{olc}} l_v i_d \tag{3h} \\
    i_{d,\text{cv}}^{\text{ref}} &amp;= k_{pv}\left(v_{d,\text{vi}}^{\text{ref}} - v_q\right) + k_{iv} \xi_d - c_f \omega_{\text{olc}} v_q + k_{\text{ffi}}i_d \tag{3i} \\
    i_{q,\text{cv}}^{\text{ref}} &amp;= k_{pv}\left(v_{q,\text{vi}}^{\text{ref}} - v_q\right) + k_{iv} \xi_q + c_f \omega_{\text{olc}} v_d + k_{\text{ffi}}i_q \tag{3j} \\
    v_d^{\text{ref-signal}} &amp;= k_{pc} \left(i_{d,\text{cv}}^{\text{ref}} - i_{d,\text{cv}}\right) + k_{ic} \gamma_d - \omega_{\text{olc}} l_f i_{q,\text{cv}} + k_{\text{ffv}}v_d - k_{\text{ad}}(v_d - \phi_d) \tag{3k} \\
    v_q^{\text{ref-signal}} &amp;= k_{pc} \left(i_{q,\text{cv}}^{\text{ref}} - i_{q,\text{cv}}\right) + k_{ic} \gamma_q + \omega_{\text{olc}} l_f i_{d,\text{cv}} + k_{\text{ffv}}v_q - k_{\text{ad}}(v_q - \phi_q) \tag{3l}
\end{align}\]</div><h2><a class="nav-anchor" id="Converter-1" href="#Converter-1">Converter</a></h2><p>This component can be used to model the dynamics of the switching process.</p><h3><a class="nav-anchor" id="Average-Model-1" href="#Average-Model-1">Average Model</a></h3><p>The average model simply output the desired reference signal since:</p><div>\[\begin{align}
v_{d}^{\text{cv}} \approx m_{d} v_{\text{dc}} \approx \frac{v_{d}^{\text{ref-signal}}}{v_{\text{dc}}} v_{\text{dc}} \approx v_{d}^{\text{ref-signal}} \tag{4a} \\
v_{q}^{\text{cv}} \approx m_{q} v_{\text{dc}} \approx \frac{v_{q}^{\text{ref-signal}}}{v_{\text{dc}}} v_{\text{dc}} \approx v_{q}^{\text{ref-signal}} \tag{4b}
\end{align}\]</div><p>where <span>$m_{dq}$</span> is the modulation signal, and <span>$v_{dq}^{\text{ref-signal}}$</span> is the voltage reference signal from the inner loop control.</p><h2><a class="nav-anchor" id="Filters-1" href="#Filters-1">Filters</a></h2><h3><a class="nav-anchor" id="LCL-Filter-1" href="#LCL-Filter-1">LCL Filter</a></h3><p>A standard LCL filter is proposed to connect the output of the converter to the grid. In this case, <span>$v_d$</span> and <span>$v_q$</span> are voltages in the capacitor, while <span>$v_d^{\text{grid}}$</span> and <span>$v_q^{\text{grid}}$</span> represent the voltage at the bus. The L filter after the capacitor can also include a step-up transformer to increase the voltage, that is model as an extra impedance.</p><div>\[\begin{align}
    \dot{i}_{d,\text{cv}} &amp;= \frac{\Omega_b}{l_f}\left( v_d^{\text{cv}} - v_d  - r_f i_{d,\text{cv}} + \omega_{\text{grid}} l_f i_{q,\text{cv}} \right) \tag{5a} \\
    \dot{i}_{q,\text{cv}} &amp;= \frac{\Omega_b}{l_f}\left( v_q^{\text{cv}} - v_q  - r_f i_{q,\text{cv}} - \omega_{\text{grid}} l_f i_{d,\text{cv}} \right) \tag{5b} \\
    \dot{v}_{d} &amp;=  \frac{\Omega_b}{c_f}\left( i_d^{\text{cv}} - i_d + \omega_{\text{grid}} c_f v_q \right) \tag{5c} \\
    \dot{v}_{q} &amp;=  \frac{\Omega_b}{c_f}\left( i_q^{\text{cv}} - i_q - \omega_{\text{grid}} c_f v_d \right) \tag{5d} \\
    \dot{i}_{d} &amp;= \frac{\Omega_b}{l_g}\left( v_d^{\text{cv}} - v_d^{\text{grid}} - r_g i_{d} + \omega_{\text{grid}} l_g i_{q,\text{cv}} \right) \tag{5e} \\
    \dot{i}_{q} &amp;= \frac{\Omega_b}{l_g}\left( v_q^{\text{cv}} - v_q^{\text{grid}} - r_g i_{q} - \omega_{\text{grid}} l_g i_{d,\text{cv}} \right) \tag{5f}
\end{align}\]</div><h2><a class="nav-anchor" id="Reference-1" href="#Reference-1">Reference</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.FixedDCSource" href="#LITS.FixedDCSource"><code>LITS.FixedDCSource</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of a Fixed DC Source that returns a fixed DC voltage</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">FixedDCSource(voltage)</code></pre><p><strong>Arguments</strong></p><ul><li><code>voltage</code>::Float64 : Fixed DC voltage to the converter</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.PLL" href="#LITS.PLL"><code>LITS.PLL</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of a Phase-Locked Loop (PLL) for VSM</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">PLL(ω_lp, kp_pll, ki_pll)</code></pre><p><strong>Arguments</strong></p><ul><li><code>ω_lp</code>::Float64 : PLL low-pass filter frequency (rad/sec)</li><li><code>kp_pll</code>::Float64 : PLL proportional gain</li><li><code>ki_pll</code>::Float64 : PLL integral gain</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.VirtualInertia" href="#LITS.VirtualInertia"><code>LITS.VirtualInertia</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of a Virtual Inertia with SRF using VSM for active power controller</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">VirtualInertia(Ta, kd, kw, ωb)</code></pre><p><strong>Arguments</strong></p><ul><li><code>Ta</code>::Float64 : VSM inertia constant</li><li><code>kd</code>::Float64 : VSM damping constant</li><li><code>kw</code>::Float64 : frequency droop gain</li><li><code>ωb</code>::Float64 : rated angular frequency</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.ReactivePowerDroop" href="#LITS.ReactivePowerDroop"><code>LITS.ReactivePowerDroop</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of a Reactive Power droop controller</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">ReactivePowerDroop(kq, ωf)</code></pre><p><strong>Arguments</strong></p><ul><li><code>kq</code>::Float64 : reactive power droop gain</li><li><code>ωf</code>::Float64 : reactive power filter cutoff frequency (rad/sec)</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.VirtualInertiaQdroop" href="#LITS.VirtualInertiaQdroop"><code>LITS.VirtualInertiaQdroop</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of a Outer-Loop controller using a virtual inertia with VSM for active power controller and a reactive power droop controller.</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">VirtualInertiaQDroop(A, R)</code></pre><p><strong>Arguments</strong></p><ul><li><code>A</code>::Float64 : Active power controller using virtual inertia with VSM</li><li><code>R</code>::Float64 : Reactive power controller using reactive power droop</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.CombinedVIwithVZ" href="#LITS.CombinedVIwithVZ"><code>LITS.CombinedVIwithVZ</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of an inner loop controller using virtual impedance, voltage controller and current controller.</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">CombinedVIwithVZ(kpv, kiv, kffv, rv, lv, kpc, kic, kffi, ωad, kad)</code></pre><p><strong>Arguments</strong></p><ul><li><code>kpv</code>::Float64 : voltage controller proportional gain</li><li><code>kiv</code>::Float64 : voltage controller integral gain</li><li><code>kffv</code>::Float64 : Binary variable to enable feed-forward gain of voltage.</li><li><code>rv</code>::Float64 : virtual resistance</li><li><code>lv</code>::Float64 : virtual inductance</li><li><code>kpc</code>::Float64 : current controller proportional gain</li><li><code>kic</code>::Float64 : current controller integral gain</li><li><code>kffi</code>::Float64 : Binary variable to enable feed-forward gain of current</li><li><code>ωad</code>::Float64 : active damping filter cutoff frequency (rad/sec)</li><li><code>kad</code>::Float64 : active damping gain</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.AvgCnvFixedDC" href="#LITS.AvgCnvFixedDC"><code>LITS.AvgCnvFixedDC</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of an average converter model</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">AvgCnvFixedDC(v_rated, s_rated)</code></pre><p><strong>Arguments</strong></p><ul><li><code>v_rated</code>::Float64 : rated voltage</li><li><code>s_rated</code>::Float64 : rated VA</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LITS.LCLFilter" href="#LITS.LCLFilter"><code>LITS.LCLFilter</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Parameters of a LCL filter outside the converter</p><p><strong>Conmutable structor</strong></p><pre><code class="language-julia">LCLFilter(lf, rf, cf, lg, rg)</code></pre><p><strong>Arguments</strong></p><ul><li><code>lf</code>::Float64 : Series inductance in p.u. of converter filter</li><li><code>rf</code>::Float64 : Series resistance in p.u. of converter filter</li><li><code>cf</code>::Float64 : Shunt capacitance in p.u. of converter filter</li><li><code>lg</code>::Float64 : Series inductance in p.u. of converter filter to the grid</li><li><code>rg</code>::Float64 : Series resistance in p.u. of converter filter to the grid</li></ul></div></div></section><footer><hr/><a class="previous" href="../gens/"><span class="direction">Previous</span><span class="title">Generator</span></a></footer></article></body></html>
